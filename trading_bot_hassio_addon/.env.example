# =====================================================================
# Day Trading Bot – local testing environment variables
# Copy this file to .env and fill in your values.
# =====================================================================

# Flag interno: indica che il bot gira in locale (non dentro Home Assistant).
# Non modificare: serve a run.sh per saltare bashio::config e leggere
# le variabili direttamente dall'ambiente.
LOCAL_DEPLOY=true

# ── Broker ────────────────────────────────────────────────────────────
# Broker da usare per le operazioni di trading.
# "xtb"     → XTB xAPI: CFD su azioni, LSE + NYSE, disponibile in Italia,
#             regime dichiarativo (plusvalenze da dichiarare in 730/Redditi PF).
# "directa" → Directa SIM: azioni reali, LSE + NYSE + Borsa Italiana,
#             regime amministrato (tasse trattenute automaticamente dal broker).
BROKER=directa

# ── Credenziali ───────────────────────────────────────────────────────
# XTB    : API_KEY = userId numerico del conto XTB
#          API_SECRET = password del conto XTB
# Directa: API_KEY = codice utente Directa (es. D12345)
#          API_SECRET = password Directa
#          Queste credenziali vengono usate da run.sh per avviare
#          automaticamente Darwin CommandLine (DCL.jar) all'interno
#          del container Docker.
API_KEY=your_user_id
API_SECRET=your_password

# Modalità paper trading (demo):
# "true"  → conto demo/simulato (SICURO – nessun soldo reale)
# "false" → conto LIVE (SOLDI REALI – usare con estrema cautela)
# Per Directa: "true" avvia Darwin in modalità -test (ordini non reali)
PAPER_TRADING=true

# ── Mercati ───────────────────────────────────────────────────────────
# Elenco separato da virgole dei mercati da monitorare.
# Valori supportati: NYSE (New York, 09:30–16:00 ET)
#                    LSE  (Londra, 08:00–16:30 GMT/BST)
EXCHANGES=NYSE,LSE

# ── Simboli ───────────────────────────────────────────────────────────
# Lista di simboli da tradare su NYSE (separati da virgola).
# Formato XTB     : AAPL.US, MSFT.US, NVDA.US, TSLA.US, AMZN.US,
#                   META.US, GOOGL.US, AMD.US, SPY.US, QQQ.US
# Formato Directa : .AAPL, .MSFT, .NVDA, .TSLA, .AMZN,
#                   .META, .GOOGL, .AMD, .SPY, .QQQ  (prefisso punto per US)
SYMBOLS_NYSE=.AAPL, .MSFT, .NVDA, .TSLA, .AMZN, .META, .GOOGL, .AMD, .SPY, .QQQ

# Lista di simboli da tradare su LSE (separati da virgola).
# Formato XTB     : BP.UK, SHEL.UK, HSBA.UK, RIO.UK, AZN.UK,
#                   ULVR.UK, GSK.UK, VOD.UK, LLOY.UK, BATS.UK
# Formato Directa : BP, SHEL, HSBA, RIO, AZN,
#                   ULVR, GSK, VOD, LLOY, BATS  (ticker semplice per LSE)
SYMBOLS_LSE=BP, VOD, HSBA, RIO, SHEL, AZN, ULVR, GSK, LLOY, BATS

# ── Gestione del rischio ───────────────────────────────────────────────
# Capitale massimo da allocare per singola posizione (nella valuta del conto).
# Es. 1000 = al massimo 1000 € per trade.
MAX_POSITION_VALUE=1000

# Stop loss percentuale: la posizione viene chiusa in perdita se il prezzo
# scende (LONG) o sale (SHORT) di questa percentuale dall'entrata.
# Es. 2.0 = stop loss al 2%.
STOP_LOSS_PCT=2.0

# Take profit percentuale: la posizione viene chiusa in profitto se il prezzo
# si muove a favore di questa percentuale dall'entrata.
# Es. 4.0 = take profit al 4%.
TAKE_PROFIT_PCT=4.0

# Perdita giornaliera massima del portafoglio: se la perdita complessiva
# della giornata supera questa soglia, nessuna nuova posizione viene aperta.
# Es. 5.0 = blocco automatico al -5% di equity giornaliero.
MAX_DAILY_LOSS_PCT=5.0

# ── Strategia ─────────────────────────────────────────────────────────
# Strategia di trading da applicare:
# "orb"      = Opening Range Breakout (consigliata per il day trading):
#              registra high/low dei primi ORB_MINUTES minuti, poi entra
#              in rottura con conferma di volume.
# "momentum" = EMA crossover + RSI: entra quando EMA-9 incrocia EMA-21
#              con RSI in zona neutrale.
STRATEGY=orb

# Durata in minuti della finestra di opening range (solo per STRATEGY=orb).
# Es. 15 = i primi 15 minuti dopo l'apertura definiscono high/low del range.
ORB_MINUTES=15

# ── Tempistiche ───────────────────────────────────────────────────────
# Minuti prima dell'apertura del mercato in cui il bot inizia a monitorare
# i prezzi e prepara i dati (pre-market watch).
PRE_MARKET_MINUTES=30

# Minuti prima della chiusura del mercato in cui tutte le posizioni aperte
# vengono chiuse automaticamente (end-of-day flat).
CLOSE_MINUTES=15

# Intervallo in secondi del loop principale: ogni quanti secondi il bot
# controlla segnali, aggiorna posizioni e scarica comandi Telegram.
CHECK_INTERVAL=30

# ── Directa SIM ───────────────────────────────────────────────────────
# Solo usato quando BROKER=directa. Ignorato per XTB.
#
# DIRECTA_HOST: indirizzo host su cui gira Darwin CommandLine (DCL.jar),
# il software di Directa che espone l'API via socket TCP (porta 10002).
#   - "127.0.0.1" (default) → DCL.jar viene scaricato e avviato
#                              automaticamente dentro il container,
#                              usando API_KEY e API_SECRET sopra.
#   - IP remoto             → salta l'avvio automatico e si connette
#                              a un'istanza Darwin già in esecuzione
#                              su un'altra macchina.
DIRECTA_HOST=127.0.0.1

# ── Integrazione Telegram (opzionale) ─────────────────────────────────
# Per abilitare le notifiche e i comandi Telegram, è necessario deployare
# il servizio relay su Render (cartella telegram_bot/) e poi compilare
# le due variabili qui sotto.
# Lasciare TELEGRAM_RELAY_URL vuoto per disabilitare completamente Telegram.
#
# TELEGRAM_RELAY_URL: URL pubblico del servizio Render.
#   Il bot HA lo usa per inviare notifiche (POST /api/notify) e
#   per scaricare i comandi in coda (GET /api/commands).
#   Es. https://trading-bot-telegram-relay.onrender.com
TELEGRAM_RELAY_URL=

# TELEGRAM_API_KEY: chiave segreta condivisa tra il bot HA e il relay Render.
#   Deve essere identica alla variabile RELAY_API_KEY impostata
#   nel dashboard di Render. Protegge gli endpoint /api/* da accessi
#   non autorizzati (header X-API-Key).
TELEGRAM_API_KEY=
